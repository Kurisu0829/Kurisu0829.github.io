---
title: 计网八股学习
date: 2024-07-11 15:17:00 +0800
categories: [学习, 八股]
tags: [八股]
---

## 一.TCP/IP 网络模型和OSI网络模型
### TCP/IP模型
* 应用层  
我们能直接接触到的就是应用层，我们使用的应用软件都是在应用层实现的，基于文件传输协议FTP、超文本传输协议HTTP、简单邮件传输协议SMTP等应用层协议，应用层不用去关心数据是如何传输的，只需要专注于为用户提供应用功能。

* 传输层  
应用层的数据包会传给传输层，其是为应用层提供网络支持的。传输层有两个传输协议，TCP和UDP。TCP的全称叫传输控制协议，TCP相比UDP多了很多特性，比如**流量控制、超时重传、拥塞控制**等，这些都是为了保证数据包能可靠地传输给对方，UDP相对来说就很简单，简单到只负责发送数据包，不保证数据包是否能抵达对方，但它实时性相对更好，传输效率也高。  
此外，应用需要传输的数据可能会非常大，当传输层的数据包大小超过MSS（TCP最大报文段长度），就要将数据包分块，在TCP协议中，我们把每个分块称为一个TCP段。  
当设备作为接收方时，传输层则要负责把数据包传给应用，但是一台设备上可能会有很多应用在接收或者传输数据，因此需要用一个编号将应用区分开来，这个编号就是端口，传输层的报文中会携带端口号，因此接收方可以识别出该报文是发送给哪个应用。  
传输层其实并不负责将数据从一个设备传输到另一个设备，传输层应用间数据传输的媒介，帮助实现通信，而实际的传输功能就交给下一层，也就是网络层。   

* 网络层  
网络层最常使用的是IP协议，IP协议会将传输层的报文作为数据部分，再加上IP包头组装成IP报文，如果IP报文大小超过MTU（以太网中一般为 1500 字节）就会再次进行分片，得到一个即将发送到网络的IP 报文。IP协议用IP地址给设备进行编号以找到对方，IP地址分成两种意义：一个是网络号，负责标识该IP地址是属于哪个「子网」的；一个是主机号，负责标识同一「子网」下的不同主机，将IP地址和子网掩码进行按位与运算就能得到网络号。  
IP协议还有另一个重要的能力就是路由，路由器寻址工作中，根据路由算法，就是要找到目标地址的子网，找到后进而把数据包转发给对应的网络内，IP协议的寻址作用是告诉我们去往下一个目的地该朝哪个方向走，路由则是根据「下一个目的地」选择路径。

* 网络接口层  
生成了IP头部之后，接下来要交给网络接口层（Link Layer）在IP头部的前面加上MAC头部，并封装成数据帧（Data frame）发送到网络上，IP头部中的接收方IP地址表示网络包的目的地，通过这个地址我们就可以判断要将包发到哪里，但在以太网的世界中，这个思路是行不通的。在以太网进行通讯要用到 MAC 地址，MAC 头部就是干这个用的，它包含了接收方和发送方的 MAC 地址等信息，网络接口层主要为网络层提供「链路级别」传输的服务，负责在以太网、WiFi 这样的底层网络上发送原始数据包，工作在网卡这个层次，使用 MAC 地址来标识网络上的设备。

### OSI模型


## 二.从输入URL到页面显示经历了什么
### HTTP
* 解析URL  
URL中开头的http或是https表示的是访问数据的协议，紧接的//后面表示的时服务器的名称，再紧接着的/......就是服务器中的文件路径，若是不指明路径，访问的就是默认文件即/index.html或是/default.html。  

* 生成HTTP请求信息  
对URL进行解析我们就明确了Web服务器和文件名，接下来就是根据这些信息来生成 HTTP 请求消息了，包括请求报文和响应报文。  
### DNS
通过浏览器解析 URL 并生成 HTTP 消息后，需要委托操作系统将消息发送给 Web 服务器，但在发送之前，还有一项工作需要完成，那就是查询服务器域名对应的 IP 地址，因为委托操作系统发送消息时，必须提供通信对象的 IP 地址，有一种服务器就专门保存了 Web 服务器域名与 IP 的对应关系，它就是 DNS 服务器。
* 域名的层级关系  
以www.server.com为例，DNS 中的域名都是用句点来分隔的，这里的句点代表了不同层次之间的界限，在域名中，越靠右的位置表示其层级越高。  
实际上域名还有最后一个点，这个最后的一个点代表根域名。也就时 . 根域是在最顶层，它的下一层就是 .com 顶级域，再下面是 server.com。所以域名的层级关系类似一个树状结构：根 DNS 服务器（.）顶级域 DNS 服务器（.com）以及权威 DNS 服务器（server.com）。根域的 DNS 服务器信息保存在互联网中所有的 DNS 服务器中，这样一来，任何 DNS 服务器就都可以找到并访问根域 DNS 服务器了，然后再一路顺藤摸瓜找到位于下层的某台目标 DNS 服务器。  

* 域名解析流程  
1. 客户端首先会发出一个 DNS 请求，问 www.server.com 的 IP 是啥，并发给本地 DNS 服务器，也就是我们在网络设置中填写的那个。
2. 本地域名服务器收到客户端的请求后，如果缓存里的表格能找到 www.server.com，则它直接返回 IP 地址，除此之外还会看hosts文件里是否存在，如果没有，本地 DNS 会去问它的根域名服务器，根域名服务器是最高层次的，它不直接用于域名解析，但能指明一条道路。
3. 根 DNS 收到来自本地 DNS 的请求后，发现后置是 .com，会给我们 .com 顶级域名服务器地址。
4. 本地 DNS 收到顶级域名服务器的地址后，发起请求问.com 顶级域名服务器www.server.com 的 IP 地址是什么。
5. 顶级域名服务器，给我们负责 www.server.com 区域的权威 DNS 服务器的地址。
6. 本地 DNS 于是转向问权威 DNS 服务器www.server.com 的 IP 地址是什么，即server.com 的权威 DNS 服务器，它是域名解析结果的原出处。
7. 权威 DNS 服务器查询后将对应的 IP 地址 X.X.X.X 告诉本地 DNS。
8. 本地 DNS 再将 IP 地址返回客户端，客户端和目标建立连接。

### 协议栈
通过 DNS 获取到 IP 后，就可以把 HTTP 的传输工作交给操作系统中的协议栈。  
应用程序（浏览器）通过调用 Socket 库，来委托协议栈工作。协议栈的上半部分有两块，分别是负责收发数据的 TCP 和 UDP 协议，这两个传输协议会接受应用层的委托执行收发数据的操作。协议栈的下面一半是用 IP 协议控制网络包收发操作，在互联网上传数据时，数据会被切分成一块块的网络包，而将网络包发送给对方的操作就是由 IP 负责的。  
此外 IP 中还包括 ICMP 协议和 ARP 协议。ICMP 用于告知网络包传送过程中产生的错误以及各种控制信息，ARP 用于根据 IP 地址查询相应的以太网 MAC 地址，IP 下面的网卡驱动程序负责控制网卡硬件，而最下面的网卡则负责完成实际的收发操作，也就是对网线中的信号执行发送和接收操作。

### TCP
HTTP 是基于 TCP 协议传输的，为此需要了解下 TCP 协议。
* TCP包头结构  
1. 源端口号和目标端口号：如果没有这两个端口号，数据就不知道应该发给哪个应用。
2. 序号：解决包乱序的问题。
3. 确认号：目的是确认发出去对方是否有收到。如果没有收到就应该重新发送，直到送达，这个是为了解决丢包的问题。
4. 状态位：例如 SYN 是发起一个连接，ACK 是回复，RST 是重新连接，FIN 是结束连接等。TCP 是面向连接的，因而双方要维护连接的状态，这些带状态位的包的发送，会引起双方的状态变更。
5. 窗口大小：TCP 要做流量控制和拥塞控制，通信双方各声明一个窗口（缓存大小），标识自己当前能够的处理能力。

* 三次握手
在 HTTP 传输数据之前，首先需要 TCP 建立连接，TCP 连接的建立，通常称为三次握手。  
1. 一开始，客户端和服务端都处于 CLOSED 状态。先是服务端主动监听某个端口，处于 LISTEN 状态。
2. 然后客户端主动发起连接 SYN，之后处于 SYN-SENT 状态。
3. 服务端收到发起的连接，返回 SYN，并且 ACK 客户端的 SYN，之后处于 SYN-RCVD 状态。
4. 客户端收到服务端发送的 SYN 和 ACK 之后，发送对 SYN 确认的 ACK，之后处于 ESTABLISHED 状态，因为它一发一收成功了。
5. 服务端收到 ACK 的 ACK 之后，处于 ESTABLISHED 状态，因为它也一发一收了。所以三次握手目的是保证双方都有发送和接收的能力。

## 三.HTTP请求报文和响应报文是怎样的

## 四.HTTP请求方式有哪些

## 五.GET请求和POST请求有哪些区别